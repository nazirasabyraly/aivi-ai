# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å VITE_CLERK_PUBLIC_KEY

## –ü—Ä–æ–±–ª–µ–º–∞
Frontend –≤—ã–¥–∞–µ—Ç –æ—à–∏–±–∫—É:
```
VITE_CLERK_PUBLIC_KEY –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
Uncaught Error: @clerk/clerk-react: Missing publishableKey
```

## –ü—Ä–∏—á–∏–Ω–∞
1. **–û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –ò–°–ü–†–ê–í–õ–ï–ù–ê**: –í `backend/app/main.py` –¥–æ–±–∞–≤–ª–µ–Ω –ø—Ä–µ—Ñ–∏–∫—Å `/api` –∫–æ –≤—Å–µ–º —Ä–æ—É—Ç–µ—Ä–∞–º
2. **–ù–æ–≤–∞—è –ø—Ä–æ–±–ª–µ–º–∞**: –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `VITE_CLERK_PUBLIC_KEY` –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä frontend

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ —Å–¥–µ–ª–∞–Ω—ã ‚úÖ

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω main.py (–æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞)
```python
# –ë—ã–ª–æ:
app.include_router(users.router, prefix="/users")

# –°—Ç–∞–ª–æ:
app.include_router(users.router, prefix="/api/users")
```

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω docker-compose.yml
```yaml
frontend:
  build:
    context: ./frontend
    dockerfile: Dockerfile
    args:  # ‚Üê –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –Ω–∞ —ç—Ç–∞–ø–µ —Å–±–æ—Ä–∫–∏
      - VITE_API_URL=https://aivi-ai.it.com/api
      - VITE_CLERK_PUBLIC_KEY=${CLERK_PUBLIC_KEY}
  environment:
    - VITE_API_URL=https://aivi-ai.it.com/api
    - VITE_CLERK_PUBLIC_KEY=${CLERK_PUBLIC_KEY}
```

### 3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –ø–æ—Ä—Ç backend
```yaml
backend:
  ports:
    - "8001:8001"  # –ë—ã–ª–æ 8000:8000
```

## –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ üöÄ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh your-server

# 2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd /path/to/nfac-project-d

# 3. –ü–æ–ª—É—á–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git pull origin main

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
chmod +x fix_clerk_env.sh
./fix_clerk_env.sh
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –†—É—á–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
```bash
# 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ .env —Ñ–∞–π–ª
cat .env | grep CLERK_PUBLIC_KEY

# 2. –ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –ø—É—Å—Ç–∞—è, –¥–æ–±–∞–≤—å—Ç–µ –µ—ë:
echo "CLERK_PUBLIC_KEY=pk_live_–≤–∞—à_–∫–ª—é—á_–∑–¥–µ—Å—å" >> .env

# 3. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose down
docker-compose build --no-cache
docker-compose up -d
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ ‚úÖ

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
chmod +x check_env_vars.sh
./check_env_vars.sh
```

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
```bash
python3 check_api_routes.py https://aivi-ai.it.com
```

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
```bash
docker-compose logs frontend | grep -i clerk
docker-compose logs backend | grep -i error
```

## –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç üéâ

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
1. ‚úÖ `https://aivi-ai.it.com/api/users/me` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 401/403 –≤–º–µ—Å—Ç–æ 404
2. ‚úÖ Frontend –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫ Clerk
3. ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Clerk —Ä–∞–±–æ—Ç–∞–µ—Ç
4. ‚úÖ –ü—Ä–æ—Ñ–∏–ª—å –∏ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## –ü–æ–ª—É—á–µ–Ω–∏–µ Clerk –∫–ª—é—á–µ–π üîë

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ [Clerk Dashboard](https://dashboard.clerk.com/last-active?path=api-keys)
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "API Keys"
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ:
   - **Publishable key** (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `pk_live_`) ‚Üí `CLERK_PUBLIC_KEY`
   - **Secret key** (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `sk_live_`) ‚Üí `CLERK_SECRET_KEY`

## –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è ‚ö†Ô∏è

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ LIVE –∫–ª—é—á–∏**: `pk_live_...` –∏ `sk_live_...`, –Ω–µ TEST –∫–ª—é—á–∏
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ–º–µ–Ω—ã**: –í Clerk Dashboard —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `aivi-ai.it.com` –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã
3. **–ö—ç—à Docker**: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `--no-cache` –ø—Ä–∏ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–µ

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º üîç

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ä–µ—à–∞–µ—Ç—Å—è:

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose ps

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ frontend
docker-compose logs frontend

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
docker exec $(docker ps -q -f name=frontend) env | grep VITE

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–±–æ—Ä–∫—É frontend
docker-compose build frontend --no-cache
``` 